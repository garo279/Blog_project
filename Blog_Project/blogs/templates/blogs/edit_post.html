{% extends "blogs/base.html" %}

{% block title %}ç¼–è¾‘æ–‡ç«  - æˆ‘çš„åšå®¢{% endblock %}

{% block content %}
    <div style="max-width: 800px; margin: 0 auto;">
        <h1 style="margin-bottom: 1rem;">âœï¸ ç¼–è¾‘æ–‡ç« </h1>
        <p style="color: #666; margin-bottom: 2rem;">æ­£åœ¨ç¼–è¾‘ï¼š{{ post.title }}</p>
        
        <form method="post" style="background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
            {% csrf_token %}
            
            {% for field in form %}
                <div style="margin-bottom: 1.5rem;">
                    <label for="{{ field.id_for_label }}" 
                           style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #333;">
                        {{ field.label }}
                        {% if field.field.required %}
                            <span style="color: #e74c3c;">*</span>
                        {% endif %}
                    </label>
                    
                    {{ field }}
                    
                    {% if field.help_text %}
                        <div style="margin-top: 0.25rem; font-size: 0.9rem; color: #666;">
                            ğŸ’¡ {{ field.help_text }}
                        </div>
                    {% endif %}
                    
                    {% if field.errors %}
                        <div style="margin-top: 0.5rem; color: #e74c3c; font-size: 0.9rem;">
                            âŒ {{ field.errors|striptags }}
                        </div>
                    {% endif %}
                </div>
            {% endfor %}
            
            <div style="display: flex; gap: 1rem; margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid #eee;">
                <button type="submit" 
                        style="padding: 0.75rem 2rem; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 500;">
                    ä¿å­˜ä¿®æ”¹
                </button>
                <a href="{% url 'blogs:post_detail' post.id %}" 
                   style="padding: 0.75rem 2rem; background: #f0f0f0; color: #666; text-decoration: none; border-radius: 4px; font-weight: 500;">
                    å–æ¶ˆ
                </a>
            </div>
        </form>
        
        <!-- æ–‡ç« ä¿¡æ¯ -->
        <div style="margin-top: 2rem; background: #f8f9fa; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #667eea;">
            <h4 style="margin-bottom: 0.5rem; color: #1976D2;">ğŸ“Š æ–‡ç« ä¿¡æ¯</h4>
            <ul style="color: #666; padding-left: 1.5rem; margin: 0;">
                <li>åˆ›å»ºæ—¶é—´ï¼š{{ post.date_added|date:"Yå¹´mæœˆdæ—¥ H:i" }}</li>
                <li>ä½œè€…ï¼š{{ post.owner.username }}</li>
                <li>å­—æ•°ï¼šçº¦ {{ post.text|wordcount }} å­—</li>
            </ul>
        </div>
    </div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // å­—ç¬¦è®¡æ•°å™¨
        const titleInput = document.querySelector('#id_title');
        const textInput = document.querySelector('#id_text');

        if (titleInput) {
            const counter = document.createElement('div');
            counter.style.marginTop = '0.25rem';
            counter.style.fontSize = '0.9rem';
            counter.style.color = '#666';
            titleInput.parentNode.insertBefore(counter, titleInput.nextSibling);

            function updateCounter() {
                const remaining = 200 - titleInput.value.length;
                counter.textContent = `å‰©ä½™å­—æ•°ï¼š${remaining}`;
                counter.style.color = remaining < 20 ? '#e74c3c' : '#666';
            }

            titleInput.addEventListener('input', updateCounter);
            updateCounter();
        }

        if (textInput) {
            function adjustHeight() {
                textInput.style.height = 'auto';
                textInput.style.height = (textInput.scrollHeight) + 'px';
            }

            textInput.addEventListener('input', adjustHeight);
            adjustHeight();
        }
    });
</script>
{% endblock %}